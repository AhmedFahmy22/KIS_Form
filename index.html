<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Online Admission Enquiry</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@100..900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@100..900&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
<style>
    body * {
        font-family: "Roboto Condensed", sans-serif;
    }
    body { background:#f4f6f9; font-family: 'Poppins', sans-serif;
    /* background-image: url(KIS_B_img3.jpg);
    background-size: contain; */
    height: fit-content;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: rgb(245, 184, 25); 
    padding: 10px;   
}
    .form-card { max-width: 650px; margin: 0 auto; background:white; padding:25px; border-radius:14px; box-shadow:0 6px 20px #0002; overflow:hidden; }
    .slide-wrapper { display:flex; width:200%; transition:transform .45s ease; }
    .step { width:50%; padding:0 25px; }
    #successOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.7); backdrop-filter:blur(4px); justify-content:center; align-items:center; }
    .successBox { background:white; padding:35px; border-radius:16px; max-width:420px; text-align:center; }
    #logo-div {
        display: flex;
        justify-content: center;
        align-items: center;
        justify-self: flex-start;
    }
    #header-div h2 {
        justify-self: center;
    }
    #logo-div img {
        width: 100px;
    }
    #header-div {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        margin-left: 10px;
        gap: 15px;
    }
    #background-overlay {
        padding: 10px;
        background-color: rgba(0, 0, 0, 0.404);
        height: 100%;
    }
    #step2 {
        display: none;
    }

    #loadingOverlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,.6);
    backdrop-filter: blur(2px);
    z-index: 9999;
    justify-content: center;
    align-items: center;
}

    .loadingBox {
        text-align: center;
    }
    #nextBtn {
        font-weight: bold;
        font-size: large;
    }

    #nextBtn:hover {
        background-color: rgb(16, 71, 53);
        border: 3px solid rgb(245, 184, 25);
        color: rgb(245, 184, 25);
    }

    #nextBtn {
        background-color: rgb(245, 184, 25);
        border: 3px solid rgb(16, 71, 53);
        color: rgb(16, 71, 53);
    }

    #step1 h4, #step2 h4 {
        color: rgb(245, 184, 25);
        font-weight: bold;
    }

    #header-div h2 {
        color: rgb(16, 71, 53);
        font-weight: bold;
    }
    span.req {
        color: red
    }

</style>
</head>
<body>

<!-- <div id="background-overlay"> -->
    <div class="form-card">
    <div id="header-div">
        <div id="logo-div"><img src="international-logo2.png" alt=""></div>
        <h2 class="text-center">KIS Admission Enquiry</h2>
    </div>

    <div id="slider" class="slide-wrapper">

        <!-- STEP 1 -->
        <form id="step1" class="step">
            <h4 class="mb-3">Student Information</h4>

            <div class="mb-3">
                <label class="form-label">Student Name<span class="req">*</span></label>
                <input type="text" name="studentName" class="form-control" required />
            </div>

            <div class="mb-3">
                <label class="form-label">Academic Year <span class="req">*</span></label>
                <select name="academicYear" class="form-select" required>
                    <option value="">Choose...</option>
                    <option>2025-2026</option>
                    <option>2026-2027</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Grade <span class="req">*</span></label>
                <select name="grade" class="form-select" required>
                    <option value="">Choose...</option>
                    <option>Year 1</option>
                    <option>Year 2</option>
                    <option>Year 3</option>
                    <option>Year 4</option>
                    <option>Year 5</option>
                    <option>Year 6</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Date of Birth <span class="req">*</span></label>
                <input type="date" name="dob" class="form-control" required />
            </div>

            <button type="submit" id="nextBtn" class="btn btn-primary w-100">Next</button>
        </form>

        <!-- STEP 2 -->
        <form id="step2" class="step">
            <h4 class="mb-3">Parent Information</h4>

            <div class="row g-3">
                <div class="col-12 col-md-6">
                    <label class="form-label">Father Name <span class="req">*</span></label>
                    <input type="text" name="fatherName" class="form-control" required />
                </div>

                <div class="col-12 col-md-6">
                    <label class="form-label">Mother Name <span class="req">*</span></label>
                    <input type="text" name="motherName" class="form-control" required />
                </div>

                <div class="col-12 col-md-6">
                    <label class="form-label">Mobile Number <span class="req">*</span></label>
                    <input type="tel" name="mobileNumber" class="form-control" pattern="^[0-9]{11}$" required/>
                </div>

                <div class="col-12 col-md-6">
                    <label class="form-label col-12">Preferred Interview <span class="req">*</span></label>
                    <!-- <select name="interviewMethod" class="form-select" required>
                        <option value="">Choose...</option>
                        <option>School Premises</option>
                        <option>Online</option>
                    </select> -->
                    <input type="radio" checked id="contactChoice1" name="interviewMethod" value="premises" class="col-2"/>
                    <label for="contactChoice1" class="col-9">School Premises</label>
                    <input type="radio" id="contactChoice2" name="interviewMethod" value="online" class="col-2"/>
                    <label for="contactChoice2"class="col-9">Online</label>
                </div>

                <div class="col-12">
                    <label class="form-label">Full Address <span class="req">*</span></label>
                    <input type="text" name="address" class="form-control" required />
                </div>

                <div class="col-12 col-md-6">
                    <label class="form-label">Father Occupation <span class="req">*</span></label>
                    <input type="text" name="fatherJob" class="form-control" required />
                </div>

                <div class="col-12 col-md-6">
                    <label class="form-label">Mother Occupation <span class="req">*</span></label>
                    <input type="text" name="motherJob" class="form-control" required />
                </div>

                <div class="col-12">
                    <label class="form-label">Email <span class="req">*</span></label>
                    <input type="email" name="email" class="form-control" required />
                </div>
            </div>

            <div class="mt-4 d-flex gap-2">
                <button type="button" id="backBtn" class="btn btn-secondary w-100">Back</button>
                <button type="button" id="resetBtn" class="btn btn-warning w-100">Reset</button>
                <button type="submit" id="submitBtn" class="btn btn-success w-100">Submit</button>
            </div>
        </form>

    </div>
<!-- </div> -->
</div>

<!-- Success Message -->
<div id="successOverlay">
    <div class="successBox">
        <h3>Thank you!</h3>
        <p>Your enquiry has been submitted successfully.<br>We will contact you soon.</p>
        <button id="successReset" class="btn btn-warning mt-3 w-100">Reset Form</button>
    </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay">
    <div class="loadingBox">
        <div class="spinner-border text-light" role="status"></div>
        <p class="mt-3 text-white fw-bold">Submitting...</p>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const slider = document.getElementById("slider");
const nextBtn = document.getElementById("nextBtn");
const backBtn = document.getElementById("backBtn");
const resetBtn = document.getElementById("resetBtn");
const successOverlay = document.getElementById("successOverlay");
const step2_div = document.getElementById("step2");

// Restore saved data
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("input, select").forEach(el => {
        if (localStorage.getItem(el.name)) el.value = localStorage.getItem(el.name);
    });
});

// Auto-save inputs
document.querySelectorAll("input, select").forEach(el => {
    el.addEventListener("input", () => localStorage.setItem(el.name, el.value));
});

function validateFirstForm() {
  const form = document.getElementById('step1'); // Replace 'yourFormId' with the actual ID of your form
  const inputs = form.querySelectorAll('input, textarea, select'); // Select all input, textarea, and select elements

  for (let i = 0; i < inputs.length; i++) {
    const field = inputs[i];

    // Skip fields that are not required or are hidden
    if (field.hasAttribute('required') || (field.type !== 'hidden' && field.type !== 'submit' && field.type !== 'button')) {
      if (field.value.trim() === '') {
        alert('Please fill in all required fields.'); // Or display a more specific error message
        field.focus(); // Focus on the empty field for user convenience
        return false; // Prevent form submission
      }
    }
  }

  return true; // All required fields are filled, allow form submission
}

// SLIDE NEXT
nextBtn.addEventListener("click", (e) => {
    e.preventDefault();
    if(validateFirstForm()) {
        slider.style.transform = "translateX(-50%)"
        step2_div.style.display = "block"
    }
});

// SLIDE BACK
backBtn.addEventListener("click", () => {
    slider.style.transform = "translateX(0%)"
    step2_div.style.display = "none"
});

// RESET (inside form)
resetBtn.addEventListener("click", () => {
    if (!confirm("Are you sure you want to reset the entire form?")) return;

    localStorage.clear();
    document.querySelectorAll("input, select").forEach(el => el.value = "");
    step2_div.style.display = "none"
    slider.style.transform = "translateX(0%)";
});

// SUCCESS RESET
successReset.addEventListener("click", () => {
    if (!confirm("Are you sure you want to start over?")) return;

    localStorage.clear();
    document.querySelectorAll("input, select").forEach(el => el.value = "");
    successOverlay.style.display = "none";
    step2_div.style.display = "none"
    slider.style.transform = "translateX(0%)";
});


// SUBMIT
// step2.addEventListener("submit", e => {
//     e.preventDefault();

//     let formData = new FormData();
//     document.querySelectorAll("input, select").forEach(el => formData.append(el.name, el.value));

//     fetch("https://script.google.com/macros/s/AKfycbwKHdnUW8Fw8WmtPKZgR6okEkKwUP98iNZMzXO6_EInIQ8MjK59WEJzy_BzeGNra6M3Xw/exec", {
//         method: "POST",
//         body: formData
//     })
//     .then(() => {
//         successOverlay.style.display = "flex";
//         localStorage.clear();
//     })
//     .catch(() => alert("Submission failed"));
// });
// let url = "https://script.google.com/macros/s/AKfycbzkYR0EFYf-A2ygGqSqrcMT-dkTgavqJ49wo8fqePOckQ7qQE9GBZDw2E8qZ2X--U1smQ/exec"
// let url = "https://script.google.com/macros/s/AKfycbwKHUW8Fw8WmtPKZgR6okEkKwUP98iNZMzXO6_EInIQ8MjK59WEJzy_BzeGNra6M3Xw/exec"
let url = "https://script.google.com/macros/s/AKfycbzF6pTKJEE0R8uO-SNCslzVldz7tfOvI5iWOqVKMt8VWuppZ9LhI1HN0SOEuHxCQcKaVA/exec"

// SUBMIT
step2.addEventListener("submit", e => {
    e.preventDefault();
    document.querySelector("button[type=submit]").disabled = true;

    // SHOW LOADING SCREEN
    document.getElementById("loadingOverlay").style.display = "flex";

    let formData = new FormData();
    const token = btoa(Date.now() + "-" + Math.random());
    formData.append("token", token);
    document.querySelectorAll("input, select").forEach(el => formData.append(el.name, el.value));

    fetch(url, {
        method: "POST",
        body: formData
    })
    .then(() => {
        // HIDE LOADING
        document.getElementById("loadingOverlay").style.display = "none";

        // SHOW SUCCESS
        successOverlay.style.display = "flex";
        localStorage.clear();
    })
    .catch((err) => {
        alert(err);

        // HIDE LOADING EVEN IF FAILED
        document.getElementById("loadingOverlay").style.display = "none";
    });
});

// step2.addEventListener("submit", e => { 
//     e.preventDefault(); // SHOW LOADING SCREEN 
//     document.getElementById("loadingOverlay").style.display = "flex"; 
//     let formData = new FormData(); 
//     document.querySelectorAll("input, select").forEach(el => formData.append(el.name, el.value)); 
//         fetch(url, 
//     { method: "POST", body: formData }) 
//     .then(() => { 
//         // HIDE LOADING 
//         document.getElementById("loadingOverlay").style.display = "none"; 
//         // SHOW SUCCESS 
//         successOverlay.style.display = "flex"; localStorage.clear(); 
//     }) 
//     .catch(() => { 
//         alert("Submission failed, please try again later."); 
//         // HIDE LOADING EVEN IF FAILED 
//         document.getElementById("loadingOverlay").style.display = "none"; 
//     }); 
// });

</script>

</body>
</html>
